---
title: 单细胞上游分析
date: 2026-01-14
share: "true"
dir: post
image:
tags:
categories: 单细胞
description:
math: flase
---
## 10X平台
### 平台介绍
- **技术原理**：利用微流控技术将带有条形码的凝胶微珠与单个细胞包裹在油包水微滴中。
- **特点**：
    - **市场占有率最高**：目前单细胞领域的“金标准”，生态系统最完善。
    - **通量高**：一次运行可捕获 500 - 10,000+ 个细胞（取决于芯片版本）。
    - **捕获率**：相对稳定，适合大规模样本的转录组图谱构建。
- **应用场景**：细胞图谱构建、差异表达分析、免疫组库（TCR/BCR）、ATAC-seq 等。
### 上游分析
- **核心工具**：**Cell Ranger** (10x 官方提供的一套命令行工具)。
    - `cellranger mkfastq`: 将 BCL 文件转为 FASTQ。
    - `cellranger count`: 比对、定量、生成表达矩阵。
    - `cellranger aggr`: 合并多个样本。
- 代码示例：
```sh
cellranger count \
  --id=$ID \
  --transcriptome=$TRANSCRIPTOME \
  --fastqs=$FASTQS \
  --sample=$SAMPLE \
  --localcores=16 \
  --localmem=64
  --create-bam=false
```

## BD平台
### 平台介绍
- **技术原理**：基于**微孔板** 技术。利用带有 UMI 和捕获序列的磁珠沉降到数万个微孔中，细胞随后沉降并落入微孔（通常是一对一捕获）。
- **特点**：
    - **靶向性能力强**：除了全转录组，BD 在靶向测序方面表现优异，可以自定义面板。
    - **捕获效率**：在某些低输入样本或特定细胞类型上表现较好。
    - **多重 PCR**：使用基于引物的扩增策略，而不是 10x 的模板转换。
- **应用场景**：全转录组分析、靶向基因panel筛选、免疫组库、单细胞多组学（如与 CITE-seq 结合）。

### 上游分析
- **核心工具**：**BD Rhapsody Analysis Pipeline**。
    - BD 官方提供了一套基于 Java 和 Python 的分析流程。
    - 通常包括 `BCL Convert` (Illumina) 或类似步骤，然后是 BD 特有的 `Rhapsody` 分析模块。
- **关键步骤**：由于 BD 的标签系统包括分子标签和细胞标签，其分析流程主要处理这两个标签的解析和纠错。
- 代码示例：
```sh
nohup cwl-runner --parallel rhapsody_pipeline_3.0.cwl pipeline_inputs_template_3.0.yml > log 2>&1 &
```
[https://bd-rhapsody-bioinfo-docs.genomics.bd.com/top_introduction.html](https://bd-rhapsody-bioinfo-docs.genomics.bd.com/top_introduction.html)

## 华大平台
### 平台介绍
- **技术原理**：**DNBelab C4** 采用液滴微流控技术，原理与 10x 类似（油包水）。但配套使用的测序仪是华大智造的 **DNBSEQ** 系列，使用 DNA 纳米球（DNB）技术和组合探针锚定连接（cPAS）技术。
- **特点**：
    - **成本优势**：在测序试剂和耗材上通常具有更高的性价比。
    - **通量**：C4 芯片一次运行可捕获数百到数千个细胞（最新 C4/T1 等通量在不断提升）。
    - **国产化**：数据产出快，设备在国内易于获取。
- **应用场景**：与 10x 类似，适用于动植物单细胞转录组测序。
### 上游分析
- **核心工具**：**dnbc4tools**。
	- [Github]({{< relref "[DNBelab_C_Series_HT_scRNA-analysis-software/doc/quickstart.md" >}} at version3.0 · MGI-tech-bioinformatics/DNBelab_C_Series_HT_scRNA-analysis-software](https://github.com/MGI-tech-bioinformatics/DNBelab_C_Series_HT_scRNA-analysis-software/blob/version3.0/doc/quickstart.md))
- 代码示例：
```sh
$dnbc4tools rna run \
    --cDNAfastq1 /test/data/test_cDNA_R1.fastq.gz \
    --cDNAfastq2 /test/data/test_cDNA_R2.fastq.gz \
    --oligofastq1 /test/data/test_oligo1_1.fq.gz,/test/data/test_oligo2_1.fq.gz \
    --oligofastq2 /test/data/test_oligo1_2.fq.gz,/test/data/test_oligo2_2.fq.gz \
    --genomeDir /database/scRNA/Mus_musculus/mm10 \
    --name test \
    --threads 30
```
