[{"content":"本文提供了一些基本的 Markdown 语法示例，可用于 Hugo 内容文件，同时还展示了 Hugo 主题中基本 HTML 元素是否带有 CSS 样式修饰。\n标题 以下 HTML \u0026lt;h1\u0026gt;—\u0026lt;h6\u0026gt; 元素代表六个级别的章节标题。\u0026lt;h1\u0026gt; 是最高级别的章节，而 \u0026lt;h6\u0026gt; 是最低级别的。\n一级标题 二级标题 三级标题 四级标题 五级标题 六级标题 段落 Xerum，quo qui aut unt expliquam qui dolut labo。Aque venitatiusda cum，voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur，offic to cor sequas etum rerum idem sintibus eiur？Quianimin porecus evelectur，cum que nis nust voloribus ratem aut omnimi，sitatur？Quiatem。Nam，omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus，sin conecerem erum fuga。Ri oditatquam，ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost，temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat。\nItatur？Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum，core et que aut hariosam ex eat。\n引用块 引用块元素表示从其他来源引用的内容，可选择性地包含引用来源（必须在 footer 或 cite 元素内），以及可选的内联更改，如注释和缩写。\n无归属的引用块 Tiam，ad mint andaepu dandae nostion secatur sequo quae。 注意 你可以在引用块内使用 Markdown 语法。\n有归属的引用块 不要通过共享内存来交流，而要通过交流来共享内存。\n— Rob Pike1\n表格 表格不是 Markdown 核心规范的一部分，但 Hugo 开箱即用地支持它们。\n姓名 年龄 鲍勃 27 爱丽丝 23 表格内的内联 Markdown 斜体 粗体 代码 斜体 粗体 代码 A B C D E F Lorem ipsum dolor sit amet，consectetur adipiscing elit。 Phasellus ultricies，sapien non euismod aliquam，dui ligula tincidunt odio，at accumsan nulla sapien eget ex。 Proin eleifend dictum ipsum，non euismod ipsum pulvinar et。Vivamus sollicitudin，quam in pulvinar aliquam，metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula。 Ut bibendum vestibulum quam，eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra。Vivamus vitae pretium sapien 代码块 使用反引号的代码块 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;zh-CN\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;示例 HTML5 文档\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;测试\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 使用四个空格缩进的代码块 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;zh-CN\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;示例 HTML5 文档\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;测试\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 差异代码块 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] 单行代码块 1 \u0026lt;p\u0026gt;一个段落\u0026lt;/p\u0026gt; 列表类型 有序列表 第一项 第二项 第三项 无序列表 列表项 另一项 另一项 嵌套列表 水果 苹果 橙子 香蕉 乳制品 牛奶 奶酪 其他元素 — abbr、sub、sup、kbd、mark GIF 是一种位图图像格式。\nH2O\nXn + Yn = Zn\n按 CTRL + ALT + Delete 结束会话。\n大多数蝾螈是夜行性动物，捕食昆虫、蠕虫和其他小型生物。\n以上引用摘自 Rob Pike 在 2015 年 11 月 18 日 Gopherfest 大会上的演讲。\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2026-01-14T00:00:00Z","permalink":"https://oranges7.github.io/p/markdown-%E8%AF%AD%E6%B3%95%E6%8C%87%E5%8D%97/","title":"Markdown 语法指南"},{"content":"保存图片 使用r时画图很多时间想同时保存pdf和png，使用这个函数会比较方便的保存\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 save_plots \u0026lt;- function( filename, # 基础文件名(不含扩展名) plot, # 要保存的图形对象(ggplot或grid对象) path = \u0026#34;.\u0026#34;, # 保存路径,默认当前目录 width = 7.2, # 宽度(英寸) height = 4.8, # 高度(英寸) dpi = 600, # PNG分辨率 formats = c(\u0026#34;pdf\u0026#34;, \u0026#34;png\u0026#34;) # 支持保存的格式 ) { library(ggplot2) library(grid) # 创建目录(如果不存在) if (!dir.exists(path)) { dir.create(path, recursive = TRUE) } # 判断是否为ggplot对象 is_ggplot \u0026lt;- inherits(plot, \u0026#34;ggplot\u0026#34;) # 遍历所有需要保存的格式 for (fmt in formats) { full_path \u0026lt;- file.path(path, paste0(filename, \u0026#34;.\u0026#34;, fmt)) if (is_ggplot) { # 如果是ggplot对象,使用ggsave switch(fmt, \u0026#34;pdf\u0026#34; = ggsave(full_path, plot, width = width, height = height), \u0026#34;png\u0026#34; = ggsave(full_path, plot, width = width, height = height, dpi = dpi, bg = \u0026#34;white\u0026#34;), \u0026#34;tiff\u0026#34; = ggsave(full_path, plot, width = width, height = height, dpi = dpi, bg = \u0026#34;white\u0026#34;), warning(paste(\u0026#34;Unsupported format:\u0026#34;, fmt)) ) } else { # 如果是grid对象(如pheatmap),使用传统图形设备 switch(fmt, \u0026#34;pdf\u0026#34; = { pdf(full_path, width = width, height = height) print(plot) dev.off() }, \u0026#34;png\u0026#34; = { png(full_path, width = width * dpi, height = height * dpi, res = dpi, bg = \u0026#34;white\u0026#34;) print(plot) dev.off() }, \u0026#34;tiff\u0026#34; = { tiff(full_path, width = width * dpi, height = height * dpi, res = dpi, bg = \u0026#34;white\u0026#34;) print(plot) dev.off() }, warning(paste(\u0026#34;Unsupported format:\u0026#34;, fmt)) ) } message(paste(\u0026#34;Saved:\u0026#34;, full_path)) } invisible(NULL) } 需要保存时使用：\n1 2 3 4 5 6 save_plots(filename=\u0026#34;00.VlnPlot\u0026#34;, #图片名 plot = v1, #要保存的对象名 width = 7.9, height = 4.75, path = \u0026#34;result\u0026#34; #保存的文件夹 ) 色板 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 mycol22 \u0026lt;- c(\u0026#34;#b0d45d\u0026#34;,\u0026#34;#356d67\u0026#34;,\u0026#34;#42465c\u0026#34;,\u0026#34;#5066a1\u0026#34;, \u0026#34;#76afda\u0026#34;,\u0026#34;#ffc556\u0026#34;, \u0026#34;#f06152\u0026#34;,\u0026#34;#eb998b\u0026#34;,\u0026#34;#a14462\u0026#34;,\u0026#34;#cca69c\u0026#34;, \u0026#34;#9e6c69\u0026#34;,\u0026#34;#7d4444\u0026#34;,\u0026#34;#562e3c\u0026#34;,\u0026#34;#a14462\u0026#34;,\u0026#34;#eb998b\u0026#34;, \u0026#34;#fddbc8\u0026#34;,\u0026#34;#356d67\u0026#34;,\u0026#34;#4c9568\u0026#34;, \u0026#34;#7fb961\u0026#34;,\u0026#34;#b0d45d\u0026#34;,\u0026#34;#ffe788\u0026#34;, \u0026#34;#f06152\u0026#34;,\u0026#34;#7d4444\u0026#34;,\u0026#34;#9e6c69\u0026#34;,\u0026#34;#cca69c\u0026#34;, \u0026#34;#5066a1\u0026#34;,\u0026#34;#76afda\u0026#34;,\u0026#34;#e8743c\u0026#34;,\u0026#34;#2873B3\u0026#34;,\u0026#34;#2EBEBE\u0026#34;,\u0026#34;#b20000\u0026#34;,\u0026#34;#74B346\u0026#34;,\u0026#34;#167153\u0026#34;,\u0026#34;#7D4444\u0026#34;,\u0026#34;#A14462\u0026#34;,\u0026#34;#8264CC\u0026#34;, \u0026#34;#BD6263\u0026#34;,\u0026#34;#8EA325\u0026#34;,\u0026#34;#A9D179\u0026#34;,\u0026#34;#84CAC0\u0026#34;,\u0026#34;#F5AE6B\u0026#34;,\u0026#34;#BCB8D3\u0026#34;,\u0026#34;#4387B5\u0026#34;, \u0026#34;#E64B35B2\u0026#34;, \u0026#34;#4DBBD5B2\u0026#34; ,\u0026#34;#00A087B2\u0026#34;, \u0026#34;#3C5488B2\u0026#34;, \u0026#34;#F39B7FB2\u0026#34;, \u0026#34;#8491B4B2\u0026#34;, \u0026#34;#91D1C2B2\u0026#34;, \u0026#34;#DC0000B2\u0026#34;, \u0026#34;#7E6148B2\u0026#34;, \u0026#34;#999999\u0026#34;, \u0026#34;#E69F00\u0026#34;, \u0026#34;#56B4E9\u0026#34;, \u0026#34;#009E73\u0026#34;, \u0026#34;#F0E442\u0026#34;, \u0026#34;#0072B2\u0026#34;, \u0026#34;#D55E00\u0026#34;, \u0026#34;#CC79A7\u0026#34;, \u0026#34;#004529\u0026#34;,\u0026#34;#088247\u0026#34;,\u0026#34;#7CC767\u0026#34;, \u0026#34;#223D6C\u0026#34;,\u0026#34;#5D90BA\u0026#34;,\u0026#34;#9ecae1\u0026#34;, \u0026#34;#8c510a\u0026#34;,\u0026#34;#bf812d\u0026#34;,\u0026#34;#D8D155\u0026#34;, \u0026#34;#b30000\u0026#34;,\u0026#34;#d73027\u0026#34;,\u0026#34;#fc9272\u0026#34;, \u0026#34;#7A142C\u0026#34;,\u0026#34;#E0367A\u0026#34;,\u0026#34;#df65b0\u0026#34;, \u0026#34;#4a1486\u0026#34;,\u0026#34;#6a51a3\u0026#34;,\u0026#34;#9e9ac8\u0026#34;, \u0026#34;#252525\u0026#34;,\u0026#34;#737373\u0026#34;,\u0026#34;#bdbdbd\u0026#34;) mycol22 \u0026lt;- unique(mycol22) ","date":"2026-01-14T00:00:00Z","permalink":"https://oranges7.github.io/p/%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/","title":"常用函数"},{"content":"10X平台 平台介绍 技术原理：利用微流控技术将带有条形码的凝胶微珠与单个细胞包裹在油包水微滴中。 特点： 市场占有率最高：目前单细胞领域的“金标准”，生态系统最完善。 通量高：一次运行可捕获 500 - 10,000+ 个细胞（取决于芯片版本）。 捕获率：相对稳定，适合大规模样本的转录组图谱构建。 应用场景：细胞图谱构建、差异表达分析、免疫组库（TCR/BCR）、ATAC-seq 等。 上游分析 核心工具：Cell Ranger (10x 官方提供的一套命令行工具)。 cellranger mkfastq: 将 BCL 文件转为 FASTQ。 cellranger count: 比对、定量、生成表达矩阵。 cellranger aggr: 合并多个样本。 代码示例： 1 2 3 4 5 6 7 8 cellranger count \\ --id=$ID \\ --transcriptome=$TRANSCRIPTOME \\ --fastqs=$FASTQS \\ --sample=$SAMPLE \\ --localcores=16 \\ --localmem=64 --create-bam=false BD平台 平台介绍 技术原理：基于微孔板 技术。利用带有 UMI 和捕获序列的磁珠沉降到数万个微孔中，细胞随后沉降并落入微孔（通常是一对一捕获）。 特点： 靶向性能力强：除了全转录组，BD 在靶向测序方面表现优异，可以自定义面板。 捕获效率：在某些低输入样本或特定细胞类型上表现较好。 多重 PCR：使用基于引物的扩增策略，而不是 10x 的模板转换。 应用场景：全转录组分析、靶向基因panel筛选、免疫组库、单细胞多组学（如与 CITE-seq 结合）。 上游分析 核心工具：BD Rhapsody Analysis Pipeline。 BD 官方提供了一套基于 Java 和 Python 的分析流程。 通常包括 BCL Convert (Illumina) 或类似步骤，然后是 BD 特有的 Rhapsody 分析模块。 关键步骤：由于 BD 的标签系统包括分子标签和细胞标签，其分析流程主要处理这两个标签的解析和纠错。 代码示例： 1 nohup cwl-runner --parallel rhapsody_pipeline_3.0.cwl pipeline_inputs_template_3.0.yml \u0026gt; log 2\u0026gt;\u0026amp;1 \u0026amp; https://bd-rhapsody-bioinfo-docs.genomics.bd.com/top_introduction.html\n华大平台 平台介绍 技术原理：DNBelab C4 采用液滴微流控技术，原理与 10x 类似（油包水）。但配套使用的测序仪是华大智造的 DNBSEQ 系列，使用 DNA 纳米球（DNB）技术和组合探针锚定连接（cPAS）技术。 特点： 成本优势：在测序试剂和耗材上通常具有更高的性价比。 通量：C4 芯片一次运行可捕获数百到数千个细胞（最新 C4/T1 等通量在不断提升）。 国产化：数据产出快，设备在国内易于获取。 应用场景：与 10x 类似，适用于动植物单细胞转录组测序。 上游分析 核心工具：dnbc4tools。 DNBelab_C_Series_HT_scRNA-analysis-software/doc/quickstart.md at version3.0 · MGI-tech-bioinformatics/DNBelab_C_Series_HT_scRNA-analysis-software 代码示例： 1 2 3 4 5 6 7 8 $dnbc4tools rna run \\ --cDNAfastq1 /test/data/test_cDNA_R1.fastq.gz \\ --cDNAfastq2 /test/data/test_cDNA_R2.fastq.gz \\ --oligofastq1 /test/data/test_oligo1_1.fq.gz,/test/data/test_oligo2_1.fq.gz \\ --oligofastq2 /test/data/test_oligo1_2.fq.gz,/test/data/test_oligo2_2.fq.gz \\ --genomeDir /database/scRNA/Mus_musculus/mm10 \\ --name test \\ --threads 30 ","date":"2026-01-14T00:00:00Z","permalink":"https://oranges7.github.io/p/%E5%8D%95%E7%BB%86%E8%83%9E%E4%B8%8A%E6%B8%B8%E5%88%86%E6%9E%90/","title":"单细胞上游分析"},{"content":"导入包和函数 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 # ========== 0.导入包和函数========== mycol22 \u0026lt;- c(\u0026#34;#b0d45d\u0026#34;,\u0026#34;#356d67\u0026#34;,\u0026#34;#42465c\u0026#34;,\u0026#34;#5066a1\u0026#34;, \u0026#34;#76afda\u0026#34;,\u0026#34;#ffc556\u0026#34;, \u0026#34;#f06152\u0026#34;,\u0026#34;#eb998b\u0026#34;,\u0026#34;#a14462\u0026#34;,\u0026#34;#cca69c\u0026#34;, \u0026#34;#9e6c69\u0026#34;,\u0026#34;#7d4444\u0026#34;,\u0026#34;#562e3c\u0026#34;,\u0026#34;#a14462\u0026#34;,\u0026#34;#eb998b\u0026#34;, \u0026#34;#fddbc8\u0026#34;,\u0026#34;#356d67\u0026#34;,\u0026#34;#4c9568\u0026#34;, \u0026#34;#7fb961\u0026#34;,\u0026#34;#b0d45d\u0026#34;,\u0026#34;#ffe788\u0026#34;, \u0026#34;#f06152\u0026#34;,\u0026#34;#7d4444\u0026#34;,\u0026#34;#9e6c69\u0026#34;,\u0026#34;#cca69c\u0026#34;, \u0026#34;#5066a1\u0026#34;,\u0026#34;#76afda\u0026#34;,\u0026#34;#e8743c\u0026#34;,\u0026#34;#2873B3\u0026#34;,\u0026#34;#2EBEBE\u0026#34;,\u0026#34;#b20000\u0026#34;,\u0026#34;#74B346\u0026#34;,\u0026#34;#167153\u0026#34;,\u0026#34;#7D4444\u0026#34;,\u0026#34;#A14462\u0026#34;,\u0026#34;#8264CC\u0026#34;, \u0026#34;#BD6263\u0026#34;,\u0026#34;#8EA325\u0026#34;,\u0026#34;#A9D179\u0026#34;,\u0026#34;#84CAC0\u0026#34;,\u0026#34;#F5AE6B\u0026#34;,\u0026#34;#BCB8D3\u0026#34;,\u0026#34;#4387B5\u0026#34;, \u0026#34;#E64B35B2\u0026#34;, \u0026#34;#4DBBD5B2\u0026#34; ,\u0026#34;#00A087B2\u0026#34;, \u0026#34;#3C5488B2\u0026#34;, \u0026#34;#F39B7FB2\u0026#34;, \u0026#34;#8491B4B2\u0026#34;, \u0026#34;#91D1C2B2\u0026#34;, \u0026#34;#DC0000B2\u0026#34;, \u0026#34;#7E6148B2\u0026#34;, \u0026#34;#999999\u0026#34;, \u0026#34;#E69F00\u0026#34;, \u0026#34;#56B4E9\u0026#34;, \u0026#34;#009E73\u0026#34;, \u0026#34;#F0E442\u0026#34;, \u0026#34;#0072B2\u0026#34;, \u0026#34;#D55E00\u0026#34;, \u0026#34;#CC79A7\u0026#34;, \u0026#34;#004529\u0026#34;,\u0026#34;#088247\u0026#34;,\u0026#34;#7CC767\u0026#34;, \u0026#34;#223D6C\u0026#34;,\u0026#34;#5D90BA\u0026#34;,\u0026#34;#9ecae1\u0026#34;, \u0026#34;#8c510a\u0026#34;,\u0026#34;#bf812d\u0026#34;,\u0026#34;#D8D155\u0026#34;, \u0026#34;#b30000\u0026#34;,\u0026#34;#d73027\u0026#34;,\u0026#34;#fc9272\u0026#34;, \u0026#34;#7A142C\u0026#34;,\u0026#34;#E0367A\u0026#34;,\u0026#34;#df65b0\u0026#34;, \u0026#34;#4a1486\u0026#34;,\u0026#34;#6a51a3\u0026#34;,\u0026#34;#9e9ac8\u0026#34;, \u0026#34;#252525\u0026#34;,\u0026#34;#737373\u0026#34;,\u0026#34;#bdbdbd\u0026#34;) mycol22 \u0026lt;- unique(mycol22) save_plots \u0026lt;- function( filename, # 基础文件名(不含扩展名) plot, # 要保存的图形对象(ggplot或grid对象) path = \u0026#34;.\u0026#34;, # 保存路径,默认当前目录 width = 7.2, # 宽度(英寸) height = 4.8, # 高度(英寸) dpi = 600, # PNG分辨率 formats = c(\u0026#34;pdf\u0026#34;, \u0026#34;png\u0026#34;) # 支持保存的格式 ) { library(ggplot2) library(grid) # 创建目录(如果不存在) if (!dir.exists(path)) { dir.create(path, recursive = TRUE) } # 判断是否为ggplot对象 is_ggplot \u0026lt;- inherits(plot, \u0026#34;ggplot\u0026#34;) # 遍历所有需要保存的格式 for (fmt in formats) { full_path \u0026lt;- file.path(path, paste0(filename, \u0026#34;.\u0026#34;, fmt)) if (is_ggplot) { # 如果是ggplot对象,使用ggsave switch(fmt, \u0026#34;pdf\u0026#34; = ggsave(full_path, plot, width = width, height = height), \u0026#34;png\u0026#34; = ggsave(full_path, plot, width = width, height = height, dpi = dpi, bg = \u0026#34;white\u0026#34;), \u0026#34;tiff\u0026#34; = ggsave(full_path, plot, width = width, height = height, dpi = dpi, bg = \u0026#34;white\u0026#34;), warning(paste(\u0026#34;Unsupported format:\u0026#34;, fmt)) ) } else { # 如果是grid对象(如pheatmap),使用传统图形设备 switch(fmt, \u0026#34;pdf\u0026#34; = { pdf(full_path, width = width, height = height) print(plot) dev.off() }, \u0026#34;png\u0026#34; = { png(full_path, width = width * dpi, height = height * dpi, res = dpi, bg = \u0026#34;white\u0026#34;) print(plot) dev.off() }, \u0026#34;tiff\u0026#34; = { tiff(full_path, width = width * dpi, height = height * dpi, res = dpi, bg = \u0026#34;white\u0026#34;) print(plot) dev.off() }, warning(paste(\u0026#34;Unsupported format:\u0026#34;, fmt)) ) } message(paste(\u0026#34;Saved:\u0026#34;, full_path)) } invisible(NULL) } library(Seurat) library(dplyr) library(ggplot2) library(tidydr) library(patchwork) library(scop) options(reticulate.conda_binary = \u0026#34;/BioData/00.Software/12.anaconda/anaconda3/bin/conda\u0026#34;) 数据读取与质控 数据读取有多种类型，需要根据实际情况进行读取 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 # ========== 1.数据导入========== raw_counts \u0026lt;- Read10X(data.dir = \u0026#34;/xxx/filter_matrix/\u0026#34;) obj1 \u0026lt;- CreateSeuratObject( counts = raw_counts, project = \u0026#34;NC1\u0026#34;, min.cells = 3 ) raw_counts \u0026lt;- Read10X(data.dir = \u0026#34;/xxx/filter_matrix/\u0026#34;) obj2 \u0026lt;- CreateSeuratObject( counts = raw_counts, project = \u0026#34;NC2\u0026#34;, min.cells = 3 ) raw_counts \u0026lt;- Read10X(data.dir = \u0026#34;/xxx/filter_matrix/\u0026#34;) obj3 \u0026lt;- CreateSeuratObject( counts = raw_counts, project = \u0026#34;NC3\u0026#34;, min.cells = 3 ) merged \u0026lt;- merge(obj1, y = c(obj2,obj3), add.cell.ids = c(\u0026#34;NC1\u0026#34;, \u0026#34;NC2\u0026#34;, \u0026#34;NC3\u0026#34;), project = \u0026#34;merged\u0026#34;) table(merged$orig.ident) merged$Sample \u0026lt;- merged$orig.ident merged \u0026lt;- JoinLayers(merged) # ========== 2.质控========== species \u0026lt;- \u0026#34;Mouse\u0026#34; if (species == \u0026#34;Mouse\u0026#34;) { merged[[\u0026#34;percent.mt\u0026#34;]] \u0026lt;- PercentageFeatureSet(merged, pattern = \u0026#34;^mt-\u0026#34;) } else if (species == \u0026#34;Human\u0026#34;) { merged[[\u0026#34;percent.mt\u0026#34;]] \u0026lt;- PercentageFeatureSet(merged, pattern = \u0026#34;^MT-\u0026#34;) } else { stop(\u0026#34;Unsupported species. Please specify \u0026#39;Mouse\u0026#39; or \u0026#39;Human\u0026#39;.\u0026#34;) } v1 \u0026lt;- VlnPlot(merged, features = c(\u0026#34;nFeature_RNA\u0026#34;, \u0026#34;nCount_RNA\u0026#34;, \u0026#34;percent.mt\u0026#34;), ncol = 3,group.by = \u0026#34;orig.ident\u0026#34;,cols = mycol22, pt.size = 0)\u0026amp; theme(axis.title.x = element_blank(), text = element_text(family = \u0026#34;serif\u0026#34;)) v1 save_plots(filename=\u0026#34;00.VlnPlot\u0026#34;, plot = v1, width = 7.9, # 宽度（英寸） height = 4.75, path = \u0026#34;result\u0026#34; ) merged \u0026lt;- subset( merged, subset = nFeature_RNA \u0026gt; 200 \u0026amp; nFeature_RNA \u0026lt; 6000 \u0026amp; nCount_RNA \u0026gt; 600 \u0026amp; nCount_RNA \u0026lt; 40000 \u0026amp; percent.mt \u0026lt; 15 ) v2 \u0026lt;- VlnPlot(merged, features = c(\u0026#34;nFeature_RNA\u0026#34;, \u0026#34;nCount_RNA\u0026#34;, \u0026#34;percent.mt\u0026#34;), ncol = 3,group.by = \u0026#34;orig.ident\u0026#34;,cols = mycol22, pt.size = 0)\u0026amp; theme(axis.title.x = element_blank(), text = element_text(family = \u0026#34;serif\u0026#34;)) v2 save_plots(filename=\u0026#34;00.VlnPlot_qc\u0026#34;, plot = v2, width = 7.9, # 宽度（英寸） height = 4.75, path = \u0026#34;result\u0026#34; ) saveRDS(merged, file = \u0026#34;01.merged_qc.rds\u0026#34;) 聚类 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 merged \u0026lt;- NormalizeData(merged) merged \u0026lt;- FindVariableFeatures(merged, selection.method = \u0026#34;vst\u0026#34;, nfeatures = 3000) #plan(sequential) merged \u0026lt;- ScaleData(merged) #merged \u0026lt;- ScaleData(merged, features = rownames(merged)) #plan(multisession, workers = 32) merged \u0026lt;- RunPCA(merged, npcs = 50, verbose = FALSE) #ElbowPlot(merged, ndims = 50,reduction = \u0026#34;pca\u0026#34;) e1 \u0026lt;- ElbowPlot(merged, ndims = 50,reduction = \u0026#34;pca\u0026#34;) e1 save_plots(\u0026#34;01.ElbowPlot\u0026#34;, e1, path = \u0026#34;result\u0026#34;, width = 9.5, height = 6.2) merged \u0026lt;- FindNeighbors(merged, reduction = \u0026#34;pca\u0026#34;, dims = 1:30) merged \u0026lt;- FindClusters(merged, resolution = 0.6) merged \u0026lt;- RunUMAP(merged, reduction = \u0026#34;pca\u0026#34;, min.dist = 0.3, dims = 1:30) library(harmony) merged \u0026lt;- RunHarmony(merged, group.by.vars = \u0026#34;orig.ident\u0026#34;, max_iter = 30) e1 \u0026lt;- ElbowPlot(merged, ndims = 30,reduction = \u0026#34;harmony\u0026#34;) e1 dim_num \u0026lt;- 20 merged \u0026lt;- FindNeighbors(merged, reduction = \u0026#34;harmony\u0026#34;, # 使用harmony! dims = 1:dim_num) merged \u0026lt;- FindClusters(merged,resolution = 0.6) merged \u0026lt;- RunUMAP(merged, reduction = \u0026#34;harmony\u0026#34;, dims = 1:dim_num, reduction.name = \u0026#34;umap_harmony\u0026#34;) p1\u0026lt;-CellDimPlot( srt = merged, group.by = c(\u0026#34;seurat_clusters\u0026#34;,\u0026#34;Sample\u0026#34;), reduction = \u0026#34;umap_harmony\u0026#34;, label = T, label_insitu =T, theme_use = \u0026#34;theme_blank\u0026#34; ) p1 save_plots(\u0026#34;02.umap_clusters\u0026#34;, p1, path = \u0026#34;result\u0026#34;, width = 7.8, height = 6.5) 注释 差异分析 细胞通讯 拟时序分析 转录因子分析 ","date":"2026-01-14T00:00:00Z","image":"https://oranges7.github.io/images/Example-1.jpg","permalink":"https://oranges7.github.io/p/%E5%8D%95%E7%BB%86%E8%83%9E%E4%B8%8B%E6%B8%B8%E5%88%86%E6%9E%90/","title":"单细胞下游分析"}]